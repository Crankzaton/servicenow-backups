<?xml version="1.0" encoding="UTF-8"?><record_update table="x_938076_now_utils_now_utils_fix_scripts">
    <x_938076_now_utils_now_utils_fix_scripts action="DELETE">
        <before>true</before>
        <description>It will update the write acl script for pa_score_notes for customers who zbooted on quebec onwards.
Customers that upgraded from before quebec will not get the write ACL updated on upgrade.

The update will be removing the condition that allows anyone to update a comment without user role specified.
Basically we need to remove this condition from the script: "!current.user ||"

Write acl from quebec onwards that needs an update must meet the following requirement:
1- The ACL was not customized
2- The ACL script has the following 3 lines:
 2.1 - "answer = new SNC.PADomainUtils().isWriteable("pa_score_notes", current.sys_id);"
 2.2 - "if (!gs.hasRole('pa_admin') &amp;&amp; !gs.hasRole('pa_power_user') &amp;&amp; !gs.hasRole('pa_viewer') &amp;&amp; !gs.hasRole('pa_contributor'))"
 2.3- "answer = answer &amp;&amp; (!current.user || gs.getUser().getID() == current.user);"</description>
        <name>Update pa_scores write acl script</name>
        <record_for_rollback>true</record_for_rollback>
        <script><![CDATA[UpdateWriteACL();

function UpdateWriteA]]></script>
        <sys_class_name>x_938076_now_utils_now_utils_fix_scripts</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-05 15:08:09</sys_created_on>
        <sys_id>4ab67b8c83e89e50c6695855eeaad330</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Update pa_scores write acl script</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>x_938076_now_utils_now_utils_fix_scripts_4ab67b8c83e89e50c6695855eeaad330</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-05 15:08:09</sys_updated_on>
        <unloadable>false</unloadable>
    </x_938076_now_utils_now_utils_fix_scripts>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</application>
        <file_path/>
        <instance_id>021f1cce1b56f510e84d2f8dee4bcb4a</instance_id>
        <instance_name>dev205033</instance_name>
        <name>x_938076_now_utils_now_utils_fix_scripts_4ab67b8c83e89e50c6695855eeaad330</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="x_938076_now_utils_now_utils_fix_scripts"&gt;&lt;x_938076_now_utils_now_utils_fix_scripts action="INSERT_OR_UPDATE"&gt;&lt;before&gt;true&lt;/before&gt;&lt;description&gt;It will update the write acl script for pa_score_notes for customers who zbooted on quebec onwards.
Customers that upgraded from before quebec will not get the write ACL updated on upgrade.

The update will be removing the condition that allows anyone to update a comment without user role specified.
Basically we need to remove this condition from the script: "!current.user ||"

Write acl from quebec onwards that needs an update must meet the following requirement:
1- The ACL was not customized
2- The ACL script has the following 3 lines:
 2.1 - "answer = new SNC.PADomainUtils().isWriteable("pa_score_notes", current.sys_id);"
 2.2 - "if (!gs.hasRole('pa_admin') &amp;amp;&amp;amp; !gs.hasRole('pa_power_user') &amp;amp;&amp;amp; !gs.hasRole('pa_viewer') &amp;amp;&amp;amp; !gs.hasRole('pa_contributor'))"
 2.3- "answer = answer &amp;amp;&amp;amp; (!current.user || gs.getUser().getID() == current.user);"&lt;/description&gt;&lt;name&gt;Update pa_scores write acl script&lt;/name&gt;&lt;record_for_rollback&gt;true&lt;/record_for_rollback&gt;&lt;script&gt;&lt;![CDATA[UpdateWriteACL();

function UpdateWriteA]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;x_938076_now_utils_now_utils_fix_scripts&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2024-09-05 15:08:09&lt;/sys_created_on&gt;&lt;sys_id&gt;4ab67b8c83e89e50c6695855eeaad330&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Update pa_scores write acl script&lt;/sys_name&gt;&lt;sys_package display_value="Now Utils" source="x_938076_now_utils"&gt;b208a7c083689e50c6695855eeaad3d2&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Now Utils"&gt;b208a7c083689e50c6695855eeaad3d2&lt;/sys_scope&gt;&lt;sys_update_name&gt;x_938076_now_utils_now_utils_fix_scripts_4ab67b8c83e89e50c6695855eeaad330&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2024-09-05 15:08:09&lt;/sys_updated_on&gt;&lt;unloadable&gt;false&lt;/unloadable&gt;&lt;/x_938076_now_utils_now_utils_fix_scripts&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-866318076</payload_hash>
        <record_name>Update pa_scores write acl script</record_name>
        <reverted_from/>
        <source>6399a38483689e50c6695855eeaad3a0</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-05 15:08:09</sys_created_on>
        <sys_id>8ab67b8c83e89e50c6695855eeaad332</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>191c2ba86290000001</sys_recorded_at>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-05 15:08:09</sys_updated_on>
        <type>Now Utils Fix Scripts</type>
        <update_guid>4eb67b8ca2e89e509ce825e028cf6831</update_guid>
        <update_guid_history>4eb67b8ca2e89e509ce825e028cf6831:-866318076</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete display_value="Update pa_scores write acl script">ff27ff00832c9e50c6695855eeaad317</sys_audit_delete>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-05 15:10:12</sys_created_on>
        <sys_db_object display_value="" name="x_938076_now_utils_now_utils_fix_scripts">x_938076_now_utils_now_utils_fix_scripts</sys_db_object>
        <sys_id>3073c8d2a4814b1c9ea703c80f5c6fa4</sys_id>
        <sys_metadata>4ab67b8c83e89e50c6695855eeaad330</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Update pa_scores write acl script</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_scope_delete display_value="">07d863aeac9d4afc8fef3dc3b97bfa10</sys_scope_delete>
        <sys_update_name>x_938076_now_utils_now_utils_fix_scripts_4ab67b8c83e89e50c6695855eeaad330</sys_update_name>
        <sys_update_version display_value="x_938076_now_utils_now_utils_fix_scripts_4ab67b8c83e89e50c6695855eeaad330">8ab67b8c83e89e50c6695855eeaad332</sys_update_version>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-05 15:10:12</sys_updated_on>
    </sys_metadata_delete>
</record_update>
