<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>78c9a2dec7031110ff1a756d5ec26053</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;public&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;global.SecurityAttributeUtil&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;true&lt;/client_callable&gt;
        &lt;description/&gt;
        &lt;name&gt;SecurityAttributeUtil&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var SecurityAttributeUtil = Class.create();
SecurityAttributeUtil.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {

	updateLocalSecurityAttribute: function() {
        var attributeId = this.getParameter('sysparm_attribute_id');
		var condition = this.getParameter('sysparm_attribute_condition');
		var gr = new GlideRecord('sys_security_attribute');
		var exists = gr.get(attributeId);
		if (exists) {
			gr.setValue('condition', condition);
			gr.update();
		}
    },

	deletePrevLocalAttribute: function() {
        var attributeId = this.getParameter('sysparm_attribute_id');
        var gr = new GlideRecord('sys_security_attribute');
        var exists = gr.get(attributeId);
        if (exists) {
			gr.deleteRecord();
		}
    },

	createSecurityAttribute: function() {
		var label = this.getParameter('sysparm_label');
		var name = this.getParameter('sysparm_name0');
		var condition = this.getParameter('sysparm_condition');
		return this._createSecurityAttribute(label, name, condition);
	},

	updateOrCreateLocalSA: function() {
		var label = this.getParameter('sysparm_label');
		var name = this.getParameter('sysparm_name0');
		var condition = this.getParameter('sysparm_condition');

		var gr = this._getGRByLabelAndName(label, name);
		if (gr.next()) { //update
			gr.setValue('condition', condition);
			gr.update();
			return gr.getUniqueValue();
		} else { //create
			return this._createSecurityAttribute(label, name, condition);
		}
	},

	_getGRByLabelAndName: function(label, name) {
		var gr = new GlideRecord('sys_security_attribute');
		gr.addQuery('label', label);
		gr.addQuery('name', name);
		gr.query();
		return gr;
	},

	_createSecurityAttribute: function(label, name, condition) {
		var gr = new GlideRecord('sys_security_attribute');
		gr.initialize();
		gr.setValue('label', label);
		gr.setValue('name', name);
		gr.setValue('condition', condition);
		gr.setValue('is_localized', 'true');
		gr.setValue('type', 'compound');
		gr.setValue('description', 'Auto Created Attribute - ' + label);
		return gr.insert();
	},

    type: 'SecurityAttributeUtil'
});]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2022-11-16 07:11:54&lt;/sys_created_on&gt;
        &lt;sys_id&gt;78c9a2dec7031110ff1a756d5ec26053&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;79&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;SecurityAttributeUtil&lt;/sys_name&gt;
        &lt;sys_package display_value="Security Attributes" source="com.glide.security.security_attributes"&gt;b1c81b9b47220210cd4e1ce4316d433a&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_78c9a2dec7031110ff1a756d5ec26053&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;jacob.sandy&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2023-05-02 13:00:00&lt;/sys_updated_on&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:39:02</sys_created_on>
        <sys_id>ca17f85d83f01210c6695855eeaad3fc</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>SecurityAttributeUtil</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_ca17f85d83f01210c6695855eeaad3fc</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:39:02</sys_updated_on>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
