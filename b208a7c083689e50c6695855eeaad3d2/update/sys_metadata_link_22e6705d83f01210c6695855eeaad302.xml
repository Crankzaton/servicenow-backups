<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>6aa992a8c35430105a09f0ad9840dd45</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;package_private&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;sn_ex_sp.TopicPageUtilSNC&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;false&lt;/client_callable&gt;
        &lt;description&gt;[WARNING: Customers should NOT modify this script]&amp;#13;
	    &amp;#13;
	    The purpose of this script include is to provide default behaviours for the TopicPageUtil script include.&amp;#13;
	    To change the behaviour of these methods (or add new methods), Customers should override/add new methods to the TopicPageUtil script include. &lt;/description&gt;
        &lt;name&gt;TopicPageUtilSNC&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var TopicPageUtilSNC = Class.create();
	TopicPageUtilSNC.prototype = {
	    initialize: function() {
	    	this.SYS_PROPERTY_ICON = 'sn_ex_sp.default.taxonomy.icon';
	    },
	    /**
	     * Returns the breadcrumbs from topic to its parent
	     * @param topicId - sys_id of topic
	     * returns the final array having breadcrumb information to display in widget
	     **/
	    fetchBreadCrumbsForTopic: function(topicId) {
	        var breadcrumb = [];
	        breadCrumb = this._fetchBreadCrumbsForTopic(topicId, breadcrumb);
	        return breadCrumb;
	    },
		
		/**
	     * Returns default topic icon image name
	     **/
		fetchDefaultIconImage: function() {
			return this._fetchImage(this.SYS_PROPERTY_ICON);
		},
		
	    _fetchBreadCrumbsForTopic: function(topicId, breadcrumb) {
	        var parentTopic;
	        var gr = new GlideRecord("topic");
	        gr.addQuery("active", true);
	        gr.addQuery("sys_id", topicId);
	        gr.query();
	        while (gr.next()) {
	            var topicName = gr.getDisplayValue('name');
	            var pageToRedirect = gr.getDisplayValue('template') || 'emp_taxonomy_topic';	
	            breadcrumb.unshift({
	                "label": topicName,
	                "url": '?id='+ pageToRedirect +'&amp;topic_id=' + topicId + '&amp;in_context=true'
	            });
	            parentTopic = gr.getValue("parent_topic");
	        }
	        if (parentTopic != null)
	            this._fetchBreadCrumbsForTopic(parentTopic, breadcrumb);
	
	        return breadcrumb;
	    },
		
		_fetchImage: function(sys_property) {
			var image_record = gs.getProperty(sys_property, '');
			var gr = new GlideRecord('db_image');
			gr.addQuery('sys_id', image_record);
			gr.addActiveQuery();
			gr.query();
			if(gr.next())
				return gr.getDisplayValue('image');
			return '';
		},

		getIcon: function(topicId) {
			var gr = new GlideRecord("topic");
			gr.get(topicId);
			if(gr.icon_url)
				return gr.icon_url.toString();
			if(gr.icon)
				return gr.getDisplayValue('icon') + '?t=small';
			return null;
		},

		getBannerImage: function(topicId) {
			var gr = new GlideRecord('topic');
			gr.get(topicId);
			if(gr.banner_image_url)
				return gr.banner_image_url.toString();
			if(gr.banner_image)
				return gr.banner_image.getDisplayValue();
			return null;
		},

		getDBImage: function(imageName) {
			var gr = new GlideRecord('db_image');
			gr.addQuery('name', imageName);
			gr.query();
			if (gr.next() &amp;&amp; gr.image)
				return gr.image.toString() + ".iix";
			return null;
		},
		
	    type: 'TopicPageUtilSNC'
	};]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2021-05-20 10:17:23&lt;/sys_created_on&gt;
        &lt;sys_id&gt;6aa992a8c35430105a09f0ad9840dd45&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;27&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;TopicPageUtilSNC&lt;/sys_name&gt;
        &lt;sys_package display_value="Employee Center" source="sn_ex_sp"&gt;4249e63a28d54d61bb6fbf61fd86cccb&lt;/sys_package&gt;
        &lt;sys_policy&gt;read&lt;/sys_policy&gt;
        &lt;sys_scope display_value="Employee Center"&gt;4249e63a28d54d61bb6fbf61fd86cccb&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_6aa992a8c35430105a09f0ad9840dd45&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2023-06-05 06:31:16&lt;/sys_updated_on&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:38:15</sys_created_on>
        <sys_id>22e6705d83f01210c6695855eeaad302</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>TopicPageUtilSNC</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_22e6705d83f01210c6695855eeaad302</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:38:15</sys_updated_on>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
