<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>24d9c8a1b0121010fa9b7381c6884abf</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;package_private&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;sn_app_eng_studio.AesEmailScript&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;false&lt;/client_callable&gt;
        &lt;description&gt;Script to generate email template for AES apps &lt;/description&gt;
        &lt;name&gt;AesEmailScript&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var AesEmailScript = Class.create();
AesEmailScript.prototype = {
    initialize: function() {},
    getStyles: function() {
        return {
            container: "font-family:  Open Sans, Arial, sans-serif;",
            main: "padding-bottom: 56px;",
            center: "text-align: center;",
            header: "font-size: 24px;",
            content: "padding-right: 10%; padding-left: 10%; line-height: 20px;",
            message: "color: #3C3C3C; font-size: 15px;",
            row: "display: table; width:100%;",
            label: "display: table-cell;  width: 20%; padding: 10px 10px 10px 0;",
            labelValue: "display: table-cell; width: 70%; padding: 10px 10px 10px 0;",
            link: "color: #01778E",
            footer: "width: 100%; background-color: #2A3E40; color: #FFFFFF; padding-top: 20px; font-size: 12px; line-height: 20px;  height: 56px;",
        };
    },
    getBody: function(userName, headerMessage, bodyMessage, footerMessage) {
        var body = '&lt;link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@600&amp;display=swap" rel="stylesheet"&gt;';
        var style = this.getStyles();
        var imageName = "servicenow_logo.svg";
        var trailingSlashRegex = /\/+$/;
        var instanceUrl =
            gs.getProperty("glide.servlet.uri") &amp;&amp;
            gs.getProperty("glide.servlet.uri").replace(trailingSlashRegex, "");
        var currentDateTime = new GlideDateTime(); // Current DateTime
        var currentYear = currentDateTime.getYearUTC();
        var dbImages = new GlideRecord("db_image");
        var imageUrl =
            instanceUrl &amp;&amp; dbImages.get("name", imageName) ?
            instanceUrl + "/" + dbImages.getDisplayValue("image") :
            undefined;
        var footer = '&lt;div style="' + style.center + '"&gt;' + footerMessage + '&lt;/div&gt;';

		footer += gs.getMessage('{0}{1} ServiceNow | All Rights Reserved{2}', ['&lt;div style="' + style.center + '"&gt;&amp;copy; ' , currentYear, '&lt;/div&gt;']);
        body += '&lt;div style="' + style.container + '"&gt;';
        body += '&lt;div style="' + style.main + '"&gt;';
        body += imageUrl ? '&lt;div style="' + style.center + '"&gt;&lt;img src="' + imageUrl + '"/&gt;&lt;/div&gt;' : '';
        body += '&lt;br /&gt;&lt;br /&gt;';
        body += '&lt;div style="' + style.content + '"&gt;';
        body += '&lt;div style="' + style.header + '"&gt;&lt;strong&gt;' + headerMessage + '&lt;/strong&gt;&lt;/div&gt;';
        body += '&lt;br /&gt;&lt;br /&gt;';
        body += '&lt;div style="' + style.message + '"&gt;';
        body += '&lt;div&gt;' + gs.getMessage('Hi {0},', userName) + '&lt;/div&gt;';
        body += '&lt;br /&gt;';
        body += bodyMessage;
        body += '&lt;br /&gt;';
        body += '&lt;div&gt;' + gs.getMessage('Thank you,') + '&lt;/div&gt;';
        body += '&lt;div&gt;' + gs.getMessage('Your IT team') + '&lt;/div&gt;';
        body += '&lt;/div&gt;';
        body += '&lt;/div&gt;';
        body += '&lt;/div&gt;';
        body += '&lt;div style="' + style.footer + '"&gt;' + footer + '&lt;/div&gt;';
        body += '&lt;/div&gt;';

        return body;
    },
	getTrailingSlashRegex: function() {
		return /\/+$/;
	},

    type: "AesEmailScript",
};]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2020-07-28 20:06:52&lt;/sys_created_on&gt;
        &lt;sys_id&gt;24d9c8a1b0121010fa9b7381c6884abf&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;4&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;AesEmailScript&lt;/sys_name&gt;
        &lt;sys_package display_value="App Engine Studio" source="sn_app_eng_studio"&gt;e046257545b47c84712b8779a9abd0cb&lt;/sys_package&gt;
        &lt;sys_policy&gt;read&lt;/sys_policy&gt;
        &lt;sys_scope display_value="App Engine Studio"&gt;e046257545b47c84712b8779a9abd0cb&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_24d9c8a1b0121010fa9b7381c6884abf&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2021-01-25 15:13:22&lt;/sys_updated_on&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:12:23</sys_created_on>
        <sys_id>6bf0345983b01210c6695855eeaad3a6</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>AesEmailScript</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_6bf0345983b01210c6695855eeaad3a6</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:12:23</sys_updated_on>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
