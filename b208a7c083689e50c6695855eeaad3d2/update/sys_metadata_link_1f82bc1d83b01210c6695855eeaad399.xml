<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>11c3dc57b300330026b4e12b86a8dc4e</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_fix"&gt;
    &lt;sys_script_fix action="INSERT_OR_UPDATE"&gt;
        &lt;before&gt;false&lt;/before&gt;
        &lt;description&gt;This will correct some of the names and links in Instance Security Center's Madrid release. Do not re-run as this will have already run once during your upgrade to Madrid.
- ISC Banner links will now point to the most updated version of the Kb and docs
- Blacklist and Whitelist will now be shown as Untrsuted and Trusted in Table Label and Choice Label&lt;/description&gt;
        &lt;name&gt;Madrid: Correct Names and Links in ISC&lt;/name&gt;
        &lt;record_for_rollback&gt;false&lt;/record_for_rollback&gt;
        &lt;script&gt;&lt;![CDATA[var banner_obj = new GlideRecord('appsec_security_update');

// Policy: Session Management
banner_obj.addQuery('sec_link','https://docs.servicenow.com/search?q=cshelp:remember-me&amp;nl');
banner_obj.query();
if(banner_obj.next()) {
	banner_obj.setValue('sec_link','/api/now/v1/context_doc_url/CSHelp:Remember-Me');
	banner_obj.update();
}

// Hardening: Live Profile
banner_obj.initialize();
banner_obj.addQuery('sec_link','https://hi.service-now.com/kb_view.do?sys_kb_id=861daf2cdbec6740fff8a345ca961976#3.14');
banner_obj.query();
if(banner_obj.next()) {
	banner_obj.setValue('sec_link','https://hi.service-now.com/kb_view.do?sysparm_article=KB0550654#3.14');
	banner_obj.update();
}

// Hardening: Input Sanitization
banner_obj.initialize();
banner_obj.addQuery('sec_link','https://hi.service-now.com/kb_view.do?sys_kb_id=861daf2cdbec6740fff8a345ca961976#2.12');
banner_obj.query();
if(banner_obj.next()) {
	banner_obj.setValue('sec_link','https://hi.service-now.com/kb_view.do?sysparm_article=KB0550654#2.12');
	banner_obj.update();
}

// Correct Labels
var domain_table_label_obj = new GlideRecordSecure('sys_documentation');
domain_table_label_obj.addQuery('name','appsec_domain_listing');
domain_table_label_obj.addQuery('label','BlackList And WhiteList Domain');
domain_table_label_obj.query();

// Change Table Name
if(domain_table_label_obj.next()) {
domain_table_label_obj.setValue('label','Untrusted and Trusted Domain');
domain_table_label_obj.setValue('plural','Untrusted and Trusted Domains');
domain_table_label_obj.update();
}

// Change Blacklists and Whitelists in Category to Untrusted and Trusted, respectively.
var domain_choice_label_obj = new GlideRecordSecure('sys_choice');
domain_choice_label_obj.addQuery('name','appsec_domain_listing');
domain_choice_label_obj.addQuery('element','dl_category');
domain_choice_label_obj.addQuery('language','en');
domain_choice_label_obj.addQuery('label','Blacklist').addOrCondition('label','Whitelist');
domain_choice_label_obj.query();

while(domain_choice_label_obj.next()) {
	if (domain_choice_label_obj.label == "Blacklist")
		domain_choice_label_obj.setValue('label','Untrusted');
	if (domain_choice_label_obj.label == "Whitelist") 
		domain_choice_label_obj.setValue('label','Trusted');
	domain_choice_label_obj.update();
}
]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_fix&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2019-03-12 18:38:48&lt;/sys_created_on&gt;
        &lt;sys_id&gt;11c3dc57b300330026b4e12b86a8dc4e&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;5&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;Madrid: Correct Names and Links in ISC&lt;/sys_name&gt;
        &lt;sys_package display_value="Instance Security Center" source="com.glide.instance_sec_center"&gt;387a706c3cf1311068bcf327dfe37f96&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_fix_11c3dc57b300330026b4e12b86a8dc4e&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2020-08-11 23:21:00&lt;/sys_updated_on&gt;
        &lt;unloadable&gt;false&lt;/unloadable&gt;
    &lt;/sys_script_fix&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:19:12</sys_created_on>
        <sys_id>1f82bc1d83b01210c6695855eeaad399</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Madrid: Correct Names and Links in ISC</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_1f82bc1d83b01210c6695855eeaad399</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:19:12</sys_updated_on>
        <tablename>sys_script_fix</tablename>
    </sys_metadata_link>
</record_update>
