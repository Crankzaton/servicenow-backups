<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>5a268c9d77752110da1f99f69c5a99ff</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;public&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;global.ITAMScopeTableAccess&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;false&lt;/client_callable&gt;
        &lt;description/&gt;
        &lt;name&gt;ITAMScopeTableAccess&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var ITAMScopeTableAccess = Class.create();
ITAMScopeTableAccess.prototype = {
	initialize: function() {
	},

	type: 'ITAMScopeTableAccess',
};

ITAMScopeTableAccess.whitelistedTables = [
	'alm_asset',
	'cmdb_hardware_model_lifecycle',
	'cmdb_consumable_model_lifecycle',
	'cmdb_hardware_product_model',
	'cmdb_consumable_product_model',
	'cmdb_model_category',
	'proc_po',
	'proc_po_item',
	'samp_entitlement_import',
	'ast_contract',
	'change_request',
	'cds_client_schedule',
	'alm_transfer_order_line',
	// HAM Tables
	'sn_hamp_hw_refresh_line_task',
	'sn_hamp_loaner_asset_order',
	'sn_hamp_loaner_asset_task',
	'sn_hamp_custom_hw_prod_model',
	'sn_hamp_hw_product',
	'sn_hamp_hw_product_model',
	'sn_hamp_hw_device_type',
	'sn_hamp_hw_manufacturer',
	'sn_hamp_asset_reclaim_task',
	'sn_hamp_contract_asset_task',
	'sn_hamp_hardware_disposal',
	'sn_hamp_rma_request_line',
	// EAM Tables
	'sn_eam_loaner_asset_order',
	'sn_ent_model',
	'sn_eam_model_lifecycle',
	'sn_eam_cd_custom_model_library',
	'sn_eam_cd_model_type',
	'sn_eam_cd_manufacturer',
	'sn_eam_cd_product_model',
	'sn_eam_cd_model_library',
	// SAAS Tables
	'samp_sw_subscription_product_definition',
	'sam_saas_consumption_summary',
	'samp_sso_application',
	'samp_sw_subscription',
	'samp_sw_subscription_profile',
	'samp_sw_reclamation_candidate',
	'samp_m2m_rule_product',
	'cmdb_software_product_model',
	'samp_sso_integration_profile',
];
ITAMScopeTableAccess.checkTableAccess = function (gr) {
	var tableName = gr.getTableName();
	// Get list of tables in the hierarchy
	var hierarchyTables = ITAMScopeTableAccess.getHierarchy(tableName);
	for (var i = 0; i &lt; hierarchyTables.length; i++) {
		// Check if the table is already whitelisted
		if (ITAMScopeTableAccess.whitelistedTables.indexOf(String(hierarchyTables[i])) &gt; -1) {
			return true;
		}
		// Check if attribute - 'internal_itam_scope_access' is set at table dictionary level
		var tableGR = new GlideRecord(hierarchyTables[i]);
		var accessAttribute = tableGR.getAttribute('internal_itam_scope_access');
		if (accessAttribute === 'true') {
			return true;
		}
		if (accessAttribute === 'false') {
			return false;
		}
	}
	return false;
};
ITAMScopeTableAccess.getHierarchy = function (table) {
	var gth = new TableUtils(table);
	var hierarchyTableList = gth.getTables();
	var hierarchyTables = [];
	for (var i = 0; i &lt; hierarchyTableList.size(); i++) {
		hierarchyTables.push(hierarchyTableList.get(i));
	}
	return hierarchyTables;
};]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2023-03-24 09:35:36&lt;/sys_created_on&gt;
        &lt;sys_id&gt;5a268c9d77752110da1f99f69c5a99ff&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;17&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;ITAMScopeTableAccess&lt;/sys_name&gt;
        &lt;sys_package display_value="Model Management" source="com.snc.model"&gt;1d64b8e83c31311068bcf327dfe37f3a&lt;/sys_package&gt;
        &lt;sys_policy&gt;read&lt;/sys_policy&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_5a268c9d77752110da1f99f69c5a99ff&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2023-04-05 09:22:05&lt;/sys_updated_on&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:37:25</sys_created_on>
        <sys_id>deb6f01d83f01210c6695855eeaad30e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>ITAMScopeTableAccess</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_deb6f01d83f01210c6695855eeaad30e</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:37:25</sys_updated_on>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
