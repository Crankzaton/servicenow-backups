<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>063014ba73232300b8d77a2f1bf6a71f</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_fix"&gt;
    &lt;sys_script_fix action="INSERT_OR_UPDATE"&gt;
        &lt;before&gt;false&lt;/before&gt;
        &lt;description&gt;Previously objects in "Item view JSON" field have no identifiers. This cause problem that you have no opportunities to manipulate them. This script go through all values inside "item view JSON" field and add identifiers to all elements.&lt;/description&gt;
        &lt;name&gt;Add identifiers to Item Views&lt;/name&gt;
        &lt;record_for_rollback&gt;false&lt;/record_for_rollback&gt;
        &lt;script&gt;&lt;![CDATA[(function() {
	var gr = new GlideRecord('sys_sg_item_view');
	gr.query();
	while (gr.next()) {
		var itemViewJson = gr.getValue('item_view_json');
		if (!itemViewJson)
			continue;

		try {
			var elementProcessor = new ItemViewElementProcessor();
			var item_view_json = elementProcessor.identifyItemViewElements(itemViewJson);
			gr.setValue('item_view_json', item_view_json);
			setDependencyFields(gr, item_view_json);
			var result = gr.update('Add identifiers to item view JSON');
			if (result)
				gs.warn(gs.getMessage('ItemView {0} updated successfully', gr.getUniqueValue()));
		} catch (err) {
			gs.warn(gs.getMessage('Error while processing ItemView {0}: {1}', [gr.getUniqueValue(), err.message]));
		}
	}

	gs.warn(gs.getMessage('Execution finished'));
	
	function setDependencyFields(glideRecord, item_view_json){
		elementList = elementProcessor.getItemViewElementsIds(item_view_json);
		var dependency_fields = [];
		for(var index=0;index&lt;elementList.length;index++) {
			if(!elementList[index].cellId)
				continue;
			
			dependency_fields.push(elementList[index].cellId+"-"+elementList[index].id);
		}
		glideRecord.dependency_fields = dependency_fields.join(",");
	}	
	
})();
]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_fix&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2019-02-14 08:44:26&lt;/sys_created_on&gt;
        &lt;sys_id&gt;063014ba73232300b8d77a2f1bf6a71f&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;34&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;Add identifiers to Item Views&lt;/sys_name&gt;
        &lt;sys_package display_value="Mobile plugin" source="com.glide.sg"&gt;2b3434a83c31311068bcf327dfe37fa3&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_fix_063014ba73232300b8d77a2f1bf6a71f&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2019-02-18 10:41:17&lt;/sys_updated_on&gt;
        &lt;unloadable&gt;false&lt;/unloadable&gt;
    &lt;/sys_script_fix&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:18:55</sys_created_on>
        <sys_id>5372f81d83b01210c6695855eeaad3c4</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Add identifiers to Item Views</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_5372f81d83b01210c6695855eeaad3c4</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:18:55</sys_updated_on>
        <tablename>sys_script_fix</tablename>
    </sys_metadata_link>
</record_update>
