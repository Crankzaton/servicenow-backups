<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>8978fba847adf950020ba9f8536d43af</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_fix"&gt;
    &lt;sys_script_fix action="INSERT_OR_UPDATE"&gt;
        &lt;before&gt;false&lt;/before&gt;
        &lt;description&gt;working&lt;/description&gt;
        &lt;name&gt;Extracting step 97 Ans&lt;/name&gt;
        &lt;record_for_rollback&gt;true&lt;/record_for_rollback&gt;
        &lt;script&gt;&lt;![CDATA[(function executeRule(current, previous /*null when async*/ ) {

var parRec = 'f6cd37e047edf950020ba9f8536d438a'; //Demand Record
var asmtRec = '4ced732447edf950020ba9f8536d43d1'; //Assessment Record
var metType = 'Demand Assessment'; //Metric name

var parent_record = new GlideRecord('dmn_demand');
if (parent_record.get(parRec)) {
    var survey_response = new GlideRecord('asmt_metric_result');
    survey_response.addQuery('instance',asmtRec);
	survey_response.addQuery('metric_type.display_value',metType);
    survey_response.addQuery('metric.name', 'Select the appropriate outcome from the Functional Business Change Committee Review');
    survey_response.query();

    var outcomePar = [];

    while (survey_response.next()) {
        if (survey_response.hasNext()) {
            outcomePar += survey_response.string_value + ',';
        } else {
            outcomePar += survey_response.string_value;
        }
    }
    parent_record.short_description = outcomePar;
    gs.print(outcomePar);
    parent_record.update();

}
var dmnResult = new GlideRecord('u_demand_results');
dmnResult.initialize();
dmnResult.u_number = parent_record.sys_id;
dmnResult.u_title = parent_record.short_description;
dmnResult.u_shrt_desc = parent_record.business_case;
dmnResult.u_additional_comments = parent_record.short_description;
dmnResult.insert();

})(current, previous);]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_fix&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;Gokul Nath&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2023-09-25 05:13:11&lt;/sys_created_on&gt;
        &lt;sys_id&gt;8978fba847adf950020ba9f8536d43af&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;Extracting step 97 Ans&lt;/sys_name&gt;
        &lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_fix_8978fba847adf950020ba9f8536d43af&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;Gokul Nath&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2023-09-25 05:54:23&lt;/sys_updated_on&gt;
        &lt;unloadable&gt;false&lt;/unloadable&gt;
    &lt;/sys_script_fix&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:18:08</sys_created_on>
        <sys_id>ff42b41d83b01210c6695855eeaad31f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Extracting step 97 Ans</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_ff42b41d83b01210c6695855eeaad31f</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:18:08</sys_updated_on>
        <tablename>sys_script_fix</tablename>
    </sys_metadata_link>
</record_update>
