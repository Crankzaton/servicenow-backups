<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>961290efff431110d959f197cddcbde6</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;
    &lt;sys_script_include action="INSERT_OR_UPDATE"&gt;
        &lt;access&gt;package_private&lt;/access&gt;
        &lt;active&gt;true&lt;/active&gt;
        &lt;api_name&gt;sn_hr_sp.GetManualReindexMessageSNC&lt;/api_name&gt;
        &lt;caller_access/&gt;
        &lt;client_callable&gt;true&lt;/client_callable&gt;
        &lt;description/&gt;
        &lt;name&gt;GetManualReindexMessageSNC&lt;/name&gt;
        &lt;script&gt;&lt;![CDATA[var GetManualReindexMessageSNC = Class.create();
GetManualReindexMessageSNC.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {
    collectTablesForManualReIndex: function() {

        var topicId = this.getParameter('sysparam_topic');
        var hasRole = gs.hasRole("taxonomy_admin") || new global.TaxonomyUtil().isTaxonomyManager() || new global.TopicPermissionUtil().isTopicManager(topicId);
        // return null if correct roles are not present
        if(!hasRole) return null;
        
        var isAisEnabled = new sn_ais.StatusApi().isAisEnabled() &amp;&amp; gs.getProperty('taxonomy.aisearch.enabled.utah');
        if(!isAisEnabled) return null;

        // continue only if correct roles are present and ais is enabled
        var portalQuery = new GlideRecord('sp_portal');
        portalQuery.get('70cd9f3b734b13001fdae9c54cf6a72f');
        var portalQuerySearchProfile = portalQuery.getDisplayValue('search_application.search_profile');
        var collect_table = [];
        var connected_content = new GlideRecord('ais_search_profile_ais_search_source_m2m');
        var taxonomyJoincheckQuery = connected_content.addJoinQuery('taxonomy_content_configuration', 'search_source.datasource.source', 'content_table');
        connected_content.addEncodedQuery('profile.label=' + portalQuerySearchProfile);
        taxonomyJoincheckQuery.addCondition('active', 'true');
        connected_content.query();
        var displayStringTables = '';
        while (connected_content.next()) {
            var to_push = connected_content.getDisplayValue('search_source.datasource');
            collect_table.push(to_push);
        }

        var collect_table_unique = collect_table.filter(function(value, index, self) {
            return self.indexOf(value) === index;
        });
        displayStringTables = '';
        for (var i = 0; i &lt; collect_table_unique.length; i++) {
            displayStringTables += collect_table_unique[i];
            if (i != collect_table_unique.length - 1) {
                displayStringTables += " , ";
            }
        }
        var response ={};
        if (displayStringTables){
            response.message = gs.getMessage('Topic table changes need to be manually reindexed for their corresponding indexed sources. Please manually reindex these table names: {0}',displayStringTables);
        }
        return JSON.stringify(response);
    },
    type: 'GetManualReindexMessageSNC'
});]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2022-11-14 17:22:23&lt;/sys_created_on&gt;
        &lt;sys_id&gt;961290efff431110d959f197cddcbde6&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;11&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;GetManualReindexMessageSNC&lt;/sys_name&gt;
        &lt;sys_package display_value="Employee Center Core" source="sn_hr_sp"&gt;3d1da2705b021200a4656ede91f91ab6&lt;/sys_package&gt;
        &lt;sys_policy&gt;read&lt;/sys_policy&gt;
        &lt;sys_scope display_value="Employee Center Core"&gt;3d1da2705b021200a4656ede91f91ab6&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_include_961290efff431110d959f197cddcbde6&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2023-01-02 12:32:59&lt;/sys_updated_on&gt;
    &lt;/sys_script_include&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:45:49</sys_created_on>
        <sys_id>9da83c5183341210c6695855eeaad30e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>GetManualReindexMessageSNC</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_9da83c5183341210c6695855eeaad30e</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:45:49</sys_updated_on>
        <tablename>sys_script_include</tablename>
    </sys_metadata_link>
</record_update>
