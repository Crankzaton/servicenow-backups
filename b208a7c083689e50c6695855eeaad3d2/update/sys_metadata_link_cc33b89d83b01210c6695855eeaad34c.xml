<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>74f70f47e1a5f810f8773ac3737c13f7</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_fix"&gt;
    &lt;sys_script_fix action="INSERT_OR_UPDATE"&gt;
        &lt;before&gt;false&lt;/before&gt;
        &lt;description&gt;This fix script provides the ability for exisiting customers to opt in for restricting scrum_master, scrum_admin from adding members to group, 
If the system property 'scrum.disallow_scrum_add_group_member' is set to true -  scrum_master, scrum_admin are not allowed to add members to group.
If the property is set to false or doesn't exist, scrum_master, scrum_admin will have the ability to add members to group.&lt;/description&gt;
        &lt;name&gt;Fix Scrum add/delete member to group ACL&lt;/name&gt;
        &lt;record_for_rollback&gt;false&lt;/record_for_rollback&gt;
        &lt;script&gt;&lt;![CDATA[updateScrumAdminACL();
gs.log('Finished Running Scrum admin fix script');

function updateScrumAdminACL() {
    gs.log('Starting fix script for Update Scrum Admin ACL');
    if (pm.isZboot()) {
        gs.log('System is zbooting, skipping update for Scrum Admin ACL');
        return;
    }
    if (!pm.isActive("com.snc.sdlc.agile.2.0")) {
        gs.log('Agile Development 2.0 is inactive, skipping update for Scrum Admin ACL');
        return;
    }
    var grScrumAdminACL = new GlideRecord('sys_security_acl');
    var scrumAdminACLs = ['877fc1dd0b232200a6acc93563673a00', '99f0d5dd0b232200a6acc93563673a16', '582352190b632200a6acc93563673a48', '3fc495110b632200a6acc93563673a28'];
    grScrumAdminACL.addQuery('sys_id', 'IN', scrumAdminACLs);
    grScrumAdminACL.query();
    while (grScrumAdminACL.next()) {
        if (!isCustomized(grScrumAdminACL)) {
            var newScriptValue = "var disableScrumAdminGroupMember = gs.getProperty('scrum.disallow_scrum_add_group_member') || false;\n" +
                "\n" +
                "var agileTeam = \"1bff3b1493030200ea933007f67ffb6d\";\n" +
                "if (disableScrumAdminGroupMember == \"true\" || disableScrumAdminGroupMember == true || \n" +
                "    !((typeof parent!='undefined' &amp;&amp; parent.type.indexOf(agileTeam)&gt;=0)||(typeof current.group!='undefined' &amp;&amp; current.group.type.indexOf(agileTeam)&gt;=0))) {\n" +
                "    answer = false;\n" +
                "}\n" +
                "else {\n" +
                "    answer = true;\n" +
                "}";
            if (grScrumAdminACL.getValue('advanced') != true)
                grScrumAdminACL.setValue('advanced', true);
            grScrumAdminACL.setValue('script', newScriptValue);
            grScrumAdminACL.setWorkflow(false);
            grScrumAdminACL.setUseEngines(false);
            grScrumAdminACL.update();
            gs.log('Successfully updated ACL ' + grScrumAdminACL.getUniqueValue() + 'for Scrum Admin');
        }
    }
}

function isCustomized(gr) {
    var detector = GlideCollisionDetector.get();
    return detector.containsKey(gr.sys_update_name);
}]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_fix&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2021-07-29 11:21:29&lt;/sys_created_on&gt;
        &lt;sys_id&gt;74f70f47e1a5f810f8773ac3737c13f7&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;21&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;Fix Scrum add/delete member to group ACL&lt;/sys_name&gt;
        &lt;sys_package display_value=""&gt;e919649247403110020ba9f8536d434c&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_fix_74f70f47e1a5f810f8773ac3737c13f7&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2021-08-03 09:22:24&lt;/sys_updated_on&gt;
        &lt;unloadable&gt;false&lt;/unloadable&gt;
    &lt;/sys_script_fix&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:21:58</sys_created_on>
        <sys_id>cc33b89d83b01210c6695855eeaad34c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Fix Scrum add/delete member to group ACL</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_cc33b89d83b01210c6695855eeaad34c</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:21:58</sys_updated_on>
        <tablename>sys_script_fix</tablename>
    </sys_metadata_link>
</record_update>
