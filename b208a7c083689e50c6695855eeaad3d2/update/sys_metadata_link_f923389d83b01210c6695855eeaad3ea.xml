<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_metadata_link">
    <sys_metadata_link action="INSERT_OR_UPDATE">
        <directory>update</directory>
        <documentkey>6ee60e4a675200101409624ad585efe7</documentkey>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_fix"&gt;
    &lt;sys_script_fix action="INSERT_OR_UPDATE"&gt;
        &lt;before&gt;false&lt;/before&gt;
        &lt;description&gt;This fix script is used to migrate all customized attributes from vendor portal to scoped vendor portal.&lt;/description&gt;
        &lt;name&gt;Synch customization to new vendor portal&lt;/name&gt;
        &lt;record_for_rollback&gt;false&lt;/record_for_rollback&gt;
        &lt;script&gt;&lt;![CDATA[var globalPortalId = 'abd3bc239f13220030581471367fcff3';
var scopedPortalId = '5cea78d2eaf811e9b075a557f74fe0b8';

/* These attributes won't be copied
    "login_page",
    "default",
    "theme",
    "url_suffix",
    "homepage",
    "sys_policy",
    "sys_package",
    "quick_start_config",
*/

/* These attributes will be copied*/
var attributesCopied = [
    "title",
    "icon",
    "logo",
    "notfound_page",
    "sp_rectangle_menu"
];

// if below is empty, copy. Or else, don't copy
// catalog category home page / catalog home page / chat queue/ KB homepage/KB knowledge base/Social QA Knowledge Base
var attributesCopiedWithCondition = [
    "sc_category_page",
    "sc_catalog_page",
    "sp_chat_queue",
    "kb_knowledge_page",
    "kb_knowledge_base",
    "sqanda_knowledge_base"
];

/* This attribute has to be appended to the end of new one from scoped vendor portal
	"css_variables"
*/
var cssAttribute = "css_variables";

migrateAttributes();

function migrateAttributes() {

    var portal = new GlideRecord('sp_portal');
    if (!portal.get(globalPortalId))
        return;

    var scopedPortal = new GlideRecord('sp_portal');
    if (!scopedPortal.get(scopedPortalId))
        return;

    for (var i = 0; i &lt; attributesCopied.length; i++) {
        scopedPortal[attributesCopied[i]] = portal[attributesCopied[i]];
    }

    for (var j = 0; j &lt; attributesCopiedWithCondition.length; j++) {
        if (scopedPortal[attributesCopiedWithCondition[j]] == '')
            scopedPortal[attributesCopiedWithCondition[j]] = portal[attributesCopiedWithCondition[j]];
    }

    var comments = "//The following block of CSS was copied from the old vendor portal. If the new vendor portal does not look right to you, you can simply remove this block to use the default styling";
    scopedPortal[cssAttribute] = scopedPortal[cssAttribute] + '\n' + comments + '\n' + portal[cssAttribute];

    scopedPortal.update();

}]]&gt;&lt;/script&gt;
        &lt;sys_class_name&gt;sys_script_fix&lt;/sys_class_name&gt;
        &lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;
        &lt;sys_created_on&gt;2020-01-13 22:18:08&lt;/sys_created_on&gt;
        &lt;sys_id&gt;6ee60e4a675200101409624ad585efe7&lt;/sys_id&gt;
        &lt;sys_mod_count&gt;20&lt;/sys_mod_count&gt;
        &lt;sys_name&gt;Synch customization to new vendor portal&lt;/sys_name&gt;
        &lt;sys_package display_value=""&gt;3baf2208138e4343807decb9a6de5340&lt;/sys_package&gt;
        &lt;sys_policy/&gt;
        &lt;sys_scope display_value=""&gt;3baf2208138e4343807decb9a6de5340&lt;/sys_scope&gt;
        &lt;sys_update_name&gt;sys_script_fix_6ee60e4a675200101409624ad585efe7&lt;/sys_update_name&gt;
        &lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;
        &lt;sys_updated_on&gt;2020-01-14 01:55:26&lt;/sys_updated_on&gt;
        &lt;unloadable&gt;false&lt;/unloadable&gt;
    &lt;/sys_script_fix&gt;
&lt;/record_update&gt;
</payload>
        <sys_class_name>sys_metadata_link</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-09-21 08:21:49</sys_created_on>
        <sys_id>f923389d83b01210c6695855eeaad3ea</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Synch customization to new vendor portal</sys_name>
        <sys_package display_value="Now Utils" source="x_938076_now_utils">b208a7c083689e50c6695855eeaad3d2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Now Utils">b208a7c083689e50c6695855eeaad3d2</sys_scope>
        <sys_update_name>sys_metadata_link_f923389d83b01210c6695855eeaad3ea</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-09-21 08:21:49</sys_updated_on>
        <tablename>sys_script_fix</tablename>
    </sys_metadata_link>
</record_update>
